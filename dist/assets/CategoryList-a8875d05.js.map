{"version":3,"file":"CategoryList-a8875d05.js","sources":["../../src/pages/Categories/CategoryList.tsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { categoryApi } from \"../../api/categoryApi\";\r\nimport Input from \"../../components/form/input/InputField\";\r\n\r\nimport type { Category } from \"../../api/categoryApi\";\r\n\r\ninterface PaginatedResponse {\r\n  body: {\r\n    categories: Category[];\r\n  };\r\n}\r\n\r\ninterface SortConfig {\r\n  key: keyof Category | \"\";\r\n  direction: \"asc\" | \"desc\";\r\n}\r\n\r\nexport default function CategoryList() {\r\n  const [categories, setCategories] = useState<Category[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(\"\");\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [sortConfig, setSortConfig] = useState<SortConfig>({ key: \"\", direction: \"asc\" });\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [deleteConfirm, setDeleteConfirm] = useState<{show: boolean; categoryId: string; categoryName: string}>({\r\n    show: false,\r\n    categoryId: \"\",\r\n    categoryName: \"\"\r\n  });\r\n  const itemsPerPage = 10;\r\n\r\n  useEffect(() => {\r\n    const fetchCategories = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const data = await categoryApi.list();\r\n        setCategories(data);\r\n      } catch (err: any) {\r\n        setError(err.response?.data?.message || \"Failed to load categories\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchCategories();\r\n  }, []);\r\n\r\n  const handleDeleteClick = (categoryId: string, categoryName: string) => {\r\n    setDeleteConfirm({\r\n      show: true,\r\n      categoryId,\r\n      categoryName\r\n    });\r\n  };\r\n\r\n  const handleDeleteConfirm = async () => {\r\n    try {\r\n      await categoryApi.remove(deleteConfirm.categoryId);\r\n      setDeleteConfirm({ show: false, categoryId: \"\", categoryName: \"\" });\r\n      setCategories(prev => prev.filter(c => c._id !== deleteConfirm.categoryId));\r\n    } catch (err: any) {\r\n      setError(err.response?.data?.message || \"Failed to delete category\");\r\n      console.error(\"Error deleting category:\", err);\r\n    }\r\n  };\r\n\r\n  const handleSort = (key: keyof Category) => {\r\n    setSortConfig((current) => ({\r\n      key,\r\n      direction: current.key === key && current.direction === \"asc\" ? \"desc\" : \"asc\",\r\n    }));\r\n  };\r\n\r\n  const renderSortIcon = (key: keyof Category) => {\r\n    if (sortConfig.key !== key) return \"↕️\";\r\n    return sortConfig.direction === \"asc\" ? \"↑\" : \"↓\";\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleString();\r\n  };\r\n\r\n  // Sort the data\r\n  const sortedCategories = [...categories].sort((a, b) => {\r\n    if (!sortConfig.key) return 0;\r\n    const aValue = a[sortConfig.key];\r\n    const bValue = b[sortConfig.key];\r\n    if (aValue < bValue) return sortConfig.direction === \"asc\" ? -1 : 1;\r\n    if (aValue > bValue) return sortConfig.direction === \"asc\" ? 1 : -1;\r\n    return 0;\r\n  });\r\n\r\n  // Filter the sorted data\r\n  const filteredCategories = sortedCategories.filter(\r\n    category => \r\n      category.name.toLowerCase().includes(searchTerm.toLowerCase()) \r\n  );\r\n\r\n  // Calculate pagination\r\n  const totalPages = Math.ceil(filteredCategories.length / itemsPerPage);\r\n  const indexOfLastItem = currentPage * itemsPerPage;\r\n  const indexOfFirstItem = indexOfLastItem - itemsPerPage;\r\n  const currentCategories = filteredCategories.slice(indexOfFirstItem, indexOfLastItem);\r\n\r\n  // Reset to first page when search changes\r\n  useEffect(() => {\r\n    setCurrentPage(1);\r\n  }, [searchTerm]);\r\n\r\n  const renderPagination = () => {\r\n    const pages = [];\r\n    for (let i = 1; i <= totalPages; i++) {\r\n      pages.push(\r\n        <button\r\n          key={i}\r\n          onClick={() => setCurrentPage(i)}\r\n          className={`px-3 py-1 mx-1 rounded ${\r\n            currentPage === i\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200 hover:bg-gray-300'\r\n          }`}\r\n        >\r\n          {i}\r\n        </button>\r\n      );\r\n    }\r\n    return pages;\r\n  };\r\n\r\n  return (\r\n    <div className=\"container mx-auto px-4 py-8\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-2xl font-bold\">Categories</h1>\r\n        <Link \r\n          to=\"/categories/add\" \r\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700\"\r\n        >\r\n          Add New Category\r\n        </Link>\r\n      </div>\r\n\r\n      <div className=\"mb-4\">\r\n        <Input\r\n          type=\"text\"\r\n          placeholder=\"Search categories...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"w-full md:w-64\"\r\n        />\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 text-red-600 rounded-md\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {loading ? (\r\n        <div className=\"text-center py-4\">Loading...</div>\r\n      ) : (\r\n        <>\r\n          <div className=\"bg-white shadow-md rounded-lg overflow-hidden\">\r\n            <table className=\"min-w-full divide-y divide-gray-200\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th \r\n                    onClick={() => handleSort(\"name\")} \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                  >\r\n                    Name {renderSortIcon(\"name\")}\r\n                  </th>\r\n                  \r\n                  <th \r\n                    onClick={() => handleSort(\"isActive\")} \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                  >\r\n                    Status {renderSortIcon(\"isActive\")}\r\n                  </th>\r\n                  <th \r\n                    onClick={() => handleSort(\"createdAt\")} \r\n                    className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer\"\r\n                  >\r\n                    Created At {renderSortIcon(\"createdAt\")}\r\n                  </th>\r\n                  <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\r\n                    Actions\r\n                  </th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"bg-white divide-y divide-gray-200\">\r\n                {currentCategories.length > 0 ? (\r\n                  currentCategories.map((category) => (\r\n                    <tr key={category._id}>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap font-medium\">{category.name}</td>\r\n                      \r\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                        <span className={`px-2 py-1 rounded ${\r\n                          category.isActive \r\n                            ? \"bg-green-100 text-green-800\" \r\n                            : \"bg-red-100 text-red-800\"\r\n                        }`}>\r\n                          {category.isActive ? \"Active\" : \"Inactive\"}\r\n                        </span>\r\n                      </td>\r\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n                        {formatDate(category.createdAt)}\r\n                      </td>\r\n                      <td className=\"px-6 py-4 text-right space-x-2\">\r\n                     \r\n                      \r\n                        <Link \r\n                          to={`/categories/edit/${category._id}`} \r\n                          className=\"text-indigo-600 hover:text-indigo-900 mr-3\"\r\n                        >\r\n                          Edit\r\n                        </Link>\r\n                        <button\r\n                          onClick={() => handleDeleteClick(category._id, category.name)}\r\n                          className=\"text-red-600 hover:text-red-900\"\r\n                        >\r\n                          Delete\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  ))\r\n                ) : (\r\n                  <tr>\r\n                    <td colSpan={5} className=\"px-6 py-4 text-center text-gray-500\">\r\n                      No categories found\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n\r\n          {filteredCategories.length > 0 && (\r\n            <div className=\"mt-4 flex justify-center items-center space-x-2\">\r\n              <button\r\n                onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}\r\n                disabled={currentPage === 1}\r\n                className=\"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50\"\r\n              >\r\n                Previous\r\n              </button>\r\n              \r\n              {renderPagination()}\r\n              \r\n              <button\r\n                onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}\r\n                disabled={currentPage === totalPages}\r\n                className=\"px-3 py-1 rounded bg-gray-200 hover:bg-gray-300 disabled:opacity-50\"\r\n              >\r\n                Next\r\n              </button>\r\n              \r\n              <span className=\"text-sm text-gray-600\">\r\n                Page {currentPage} of {totalPages}\r\n              </span>\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {deleteConfirm.show && (\r\n        <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center\">\r\n          <div className=\"relative bg-white rounded-lg p-8 max-w-md mx-auto\">\r\n            <h2 className=\"text-xl font-bold mb-4\">Confirm Delete</h2>\r\n            <p className=\"mb-6\">\r\n              Are you sure you want to delete the category \"{deleteConfirm.categoryName}\"? This action cannot be undone.\r\n            </p>\r\n            <div className=\"flex justify-end space-x-4\">\r\n              <button\r\n                onClick={() => setDeleteConfirm({ show: false, categoryId: \"\", categoryName: \"\" })}\r\n                className=\"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={handleDeleteConfirm}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700\"\r\n              >\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"names":["CategoryList","categories","setCategories","useState","loading","setLoading","error","setError","searchTerm","setSearchTerm","sortConfig","setSortConfig","currentPage","setCurrentPage","deleteConfirm","setDeleteConfirm","itemsPerPage","useEffect","data","categoryApi","err","_b","_a","handleDeleteClick","categoryId","categoryName","handleDeleteConfirm","prev","c","handleSort","key","current","renderSortIcon","formatDate","dateString","filteredCategories","a","b","aValue","bValue","category","totalPages","indexOfLastItem","indexOfFirstItem","currentCategories","renderPagination","pages","i","jsx","jsxs","Link","Input","e","Fragment"],"mappings":"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"}